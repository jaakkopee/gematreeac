<!DOCTYPE html>
<html>
<head>
    <title>GemaTreeAC JavaScript Test</title>
</head>
<body>
    <h1>GemaTreeAC JavaScript Module Test</h1>
    <div id="output"></div>
    
    <script src="js/alphabet.js"></script>
    <script src="js/gemNumFuncs.js"></script>
    <script src="js/getwordsfromdbs.js"></script>
    <script src="js/ndigitsets3.js"></script>
    
    <script>
        function runTests() {
            const output = document.getElementById('output');
            let testResults = [];

            try {
                // Test 1: Check if modules loaded
                if (typeof window.GemaTreeAC === 'object') {
                    testResults.push('✓ GemaTreeAC namespace created');
                } else {
                    testResults.push('✗ GemaTreeAC namespace not found');
                    throw new Error('GemaTreeAC namespace not found');
                }

                // Test 2: Test getCipher function
                if (typeof window.GemaTreeAC.getCipher === 'function') {
                    const cipher = window.GemaTreeAC.getCipher('ScaExt');
                    if (cipher && cipher['a'] === 1) {
                        testResults.push('✓ getCipher function works');
                    } else {
                        testResults.push('✗ getCipher function failed - cipher: ' + JSON.stringify(cipher));
                    }
                } else {
                    testResults.push('✗ getCipher function not found');
                }

                // Test 3: Test getGematria function
                if (typeof window.GemaTreeAC.getGematria === 'function') {
                    const gemValue = window.GemaTreeAC.getGematria('hello', 'ScaExt');
                    if (typeof gemValue === 'number') {
                        testResults.push(`✓ getGematria('hello', 'ScaExt') = ${gemValue}`);
                    } else {
                        testResults.push('✗ getGematria function failed - result: ' + gemValue);
                    }
                } else {
                    testResults.push('✗ getGematria function not found');
                }

                // Test 4: Test getRootNumber function
                if (typeof window.GemaTreeAC.getRootNumber === 'function') {
                    const root = window.GemaTreeAC.getRootNumber(123);
                    if (root === 6) { // 1+2+3 = 6
                        testResults.push('✓ getRootNumber function works');
                    } else {
                        testResults.push('✗ getRootNumber function failed - result: ' + root);
                    }
                } else {
                    testResults.push('✗ getRootNumber function not found');
                }

                // Test 5: Test getParentList function
                if (typeof window.GemaTreeAC.getParentList === 'function') {
                    const parents = window.GemaTreeAC.getParentList(123);
                    if (Array.isArray(parents) && parents[0] === 123) {
                        testResults.push('✓ getParentList function works');
                    } else {
                        testResults.push('✗ getParentList function failed - result: ' + JSON.stringify(parents));
                    }
                } else {
                    testResults.push('✗ getParentList function not found');
                }

                // Test 6: Test deep memory functions
                if (typeof window.GemaTreeAC.getDeepMem === 'function') {
                    const deepMem = window.GemaTreeAC.getDeepMem();
                    if (Array.isArray(deepMem)) {
                        testResults.push(`✓ getDeepMem function works - ${deepMem.length} words`);
                    } else {
                        testResults.push('✗ getDeepMem function failed');
                    }
                } else {
                    testResults.push('✗ getDeepMem function not found');
                }

                // Test 7: Test ndigitsets functions
                if (typeof window.GemaTreeAC.clearRAM === 'function' && 
                    typeof window.GemaTreeAC.addWord === 'function' &&
                    typeof window.GemaTreeAC.printAll === 'function') {
                    window.GemaTreeAC.clearRAM();
                    window.GemaTreeAC.addWord('test', 'ScaExt');
                    const output = window.GemaTreeAC.printAll('ScaExt');
                    if (typeof output === 'string') {
                        testResults.push('✓ ndigitsets functions work');
                    } else {
                        testResults.push('✗ ndigitsets functions failed');
                    }
                } else {
                    testResults.push('✗ ndigitsets functions not found');
                }

                // Test 8: List all available functions
                const availableFunctions = Object.keys(window.GemaTreeAC).filter(key => typeof window.GemaTreeAC[key] === 'function');
                testResults.push(`Available functions: ${availableFunctions.join(', ')}`);

            } catch (error) {
                testResults.push('✗ Error during testing: ' + error.message);
                testResults.push('Stack trace: ' + error.stack);
            }

            output.innerHTML = testResults.join('<br>');
        }

        // Run tests when page loads
        window.addEventListener('load', runTests);
    </script>
</body>
</html>